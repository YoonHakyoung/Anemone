<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Concert List</title>
<style>
	@font-face {
		font-family: 'Pretendard-Regular';
		src: url('https://cdn.jsdelivr.net/gh/Project-Noonnu/noonfonts_2107@1.1/Pretendard-Regular.woff') format('woff');
		font-weight: 400;
		font-style: normal;
	}
	body{
		margin: 0;
		padding: 0;
		font-family: 'Pretendard-Regular';
	}
	.event-info {
		align-items: center;
		border: 1px solid #ccc;
		padding: 10px;
		margin-bottom: 20px;
		display: flex;
	}
	.event-info img {
		width: 300px;
		height: 450px;
		margin-right: 20px; /* ì´ë¯¸ì§€ì™€ ë‚´ìš© ì‚¬ì´ ê°„ê²© */
	}
	.event-info button {
		margin: 10px 10px 0 ;
	}
	#eventsList{
		margin: 0 100px;
	}
	#currentPage{
		margin: 0 25px;
	}
	@media (min-width: 768px) {
		div > .col-sm-3 {
		width: 100px;
		}
	}
	hr {
		margin: 10px !important;
	}
	.title {
		text-align: center;
		font-family: Pretendard-Regular;
		font-weight: 600;
		font-size: 40px;
		margin-bottom: 30px;
	}
	.row {
		font-size: 15px;
		font-family: Pretendard-Regular;
		
	}
	.col-sm-3{
		text-align: center;
	}
	#pagination{
		margin-bottom: 30px;
		font-family: Pretendard-Regular;
	}
	.interest-btn {
		background-color: #f0f0f0; /* ê¸°ë³¸ ìƒ‰ìƒ */
	}

	.interest-btn.interest-selected {
		background-color: #f7e0d1; /* ì„ íƒëœ ê²½ìš° ìƒ‰ìƒ ë³€ê²½ */
	}

</style>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

</head>
<body>
<div> <h1 class="title">ê³µì—° ì •ë³´</h1> </div>

<div id="eventsList"></div>
<div id="pagination" class="text-center">
	<button onclick="prevPage()" class="btn btn-default">ì´ì „</button>
	<span id="currentPage"></span>
	<button onclick="nextPage()" class="btn btn-default">ë‹¤ìŒ</button>
</div>

<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">ğŸ« ì˜ˆë§¤í•˜ê¸°</h4>
      </div>
      <div class="modal-body">
        <p>ì˜ˆë§¤í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
      </div>
      <div class="modal-footer">
		<button type="button" class="btn btn-primary" data-dismiss="modal">Accept</button>
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>

<script>
// XMLHttpRequest ê°ì²´ ìƒì„±
var xhttp = new XMLHttpRequest();

// XML íŒŒì¼ì˜ URL ì„¤ì •
var key = "7a7a456a7879686b313030514d69784a"; // OpenAPIì—ì„œ ë°œê¸‰ëœ ì¸ì¦í‚¤
var type = "xml"; // ìš”ì²­ íŒŒì¼ íƒ€ì… (xml)
var service = "culturalEventInfo"; // ì„œë¹„ìŠ¤ëª… (culturalEventInfo)
var currentPage = 1; // í˜„ì¬ í˜ì´ì§€
var itemsPerPage = 10; // í˜ì´ì§€ ë‹¹ í•­ëª© ìˆ˜

// í˜ì´ì§€ ë²ˆí˜¸ë¥¼ ë°›ì•„ ì‹œì‘ê³¼ ë ìœ„ì¹˜ë¥¼ ê³„ì‚°í•˜ëŠ” í•¨ìˆ˜
function calculateRange(page) {
  var start = (page - 1) * itemsPerPage + 1;
  var end = start + itemsPerPage - 1;
  return [start, end];
}

// í˜ì´ì§€ ë¡œë“œ í•¨ìˆ˜
function loadPage(page) {
  currentPage = page; // í˜„ì¬ í˜ì´ì§€ ì—…ë°ì´íŠ¸
  var range = calculateRange(page);
  var startIndex = range[0];
  var endIndex = range[1];

  // ë²„íŠ¼
  var button = "button";
  var btn = "btn";

  // URL ì„¤ì •
  var url = "http://openapi.seoul.go.kr:8088/" + key + "/" + type + "/" + service + "/" + startIndex + "/" + endIndex + "/";

  // ìš”ì²­ ì´ˆê¸°í™”
  xhttp.open("GET", url, true);

  // ìš”ì²­ ì™„ë£Œ í›„ ì‹¤í–‰ë  í•¨ìˆ˜ ì„¤ì •
  xhttp.onreadystatechange = function() {
    // ìš”ì²­ì´ ì™„ë£Œë˜ê³  ì‘ë‹µì´ ì •ìƒì ìœ¼ë¡œ ë„ì°©í•œ ê²½ìš°
    if (this.readyState == 4 && this.status == 200) {
      // XML ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
      var xmlDoc = this.responseXML;

      // í–‰ì‚¬ ëª©ë¡ì„ ë‹´ì„ div ìš”ì†Œ ì„ íƒ
      var eventsListDiv = document.getElementById("eventsList");
      eventsListDiv.innerHTML = ''; // ì´ì „ í•­ëª© ì§€ìš°ê¸°

      // ê° í–‰ì‚¬ ì •ë³´ ì²˜ë¦¬
      var events = xmlDoc.getElementsByTagName("row");
      for (var i = 0; i < events.length; i++) {
        var title = events[i].getElementsByTagName("TITLE")[0].childNodes[0] ? events[i].getElementsByTagName("TITLE")[0].childNodes[0].nodeValue : "";
        var date = events[i].getElementsByTagName("DATE")[0].childNodes[0] ? events[i].getElementsByTagName("DATE")[0].childNodes[0].nodeValue : "";
        var place = events[i].getElementsByTagName("PLACE")[0].childNodes[0] ? events[i].getElementsByTagName("PLACE")[0].childNodes[0].nodeValue : "";
        var org_name = events[i].getElementsByTagName("ORG_NAME")[0].childNodes[0] ? events[i].getElementsByTagName("ORG_NAME")[0].childNodes[0].nodeValue : "";
        var use_trgt = events[i].getElementsByTagName("USE_TRGT")[0].childNodes[0] ? events[i].getElementsByTagName("USE_TRGT")[0].childNodes[0].nodeValue : "";
        var use_fee = events[i].getElementsByTagName("USE_FEE")[0].childNodes[0] ? events[i].getElementsByTagName("USE_FEE")[0].childNodes[0].nodeValue : "";
        var player = events[i].getElementsByTagName("PLAYER")[0].childNodes[0] ? events[i].getElementsByTagName("PLAYER")[0].childNodes[0].nodeValue : "";
        var program = events[i].getElementsByTagName("PROGRAM")[0].childNodes[0] ? events[i].getElementsByTagName("PROGRAM")[0].childNodes[0].nodeValue : "";
        var etc_desc = events[i].getElementsByTagName("ETC_DESC")[0].childNodes[0] ? events[i].getElementsByTagName("ETC_DESC")[0].childNodes[0].nodeValue : "";
        var org_link = events[i].getElementsByTagName("ORG_LINK")[0].childNodes[0] ? events[i].getElementsByTagName("ORG_LINK")[0].childNodes[0].nodeValue : "";
        var main_img = events[i].getElementsByTagName("MAIN_IMG")[0].childNodes[0] ? events[i].getElementsByTagName("MAIN_IMG")[0].childNodes[0].nodeValue : "";
        var rgstdate = events[i].getElementsByTagName("RGSTDATE")[0].childNodes[0] ? events[i].getElementsByTagName("RGSTDATE")[0].childNodes[0].nodeValue : "";
        var ticket = events[i].getElementsByTagName("TICKET")[0].childNodes[0] ? events[i].getElementsByTagName("TICKET")[0].childNodes[0].nodeValue : "";
        var start_date = events[i].getElementsByTagName("STRTDATE")[0].childNodes[0] ? events[i].getElementsByTagName("STRTDATE")[0].childNodes[0].nodeValue : "";
        var end_date = events[i].getElementsByTagName("END_DATE")[0].childNodes[0] ? events[i].getElementsByTagName("END_DATE")[0].childNodes[0].nodeValue : "";
        var themecode = events[i].getElementsByTagName("THEMECODE")[0].childNodes[0] ? events[i].getElementsByTagName("THEMECODE")[0].childNodes[0].nodeValue : "";
        var lot = events[i].getElementsByTagName("LOT")[0].childNodes[0] ? events[i].getElementsByTagName("LOT")[0].childNodes[0].nodeValue : "";
        var lat = events[i].getElementsByTagName("LAT")[0].childNodes[0] ? events[i].getElementsByTagName("LAT")[0].childNodes[0].nodeValue : "";
        var is_free = events[i].getElementsByTagName("IS_FREE")[0].childNodes[0] ? events[i].getElementsByTagName("IS_FREE")[0].childNodes[0].nodeValue : "";
        var hmpg_addr = events[i].getElementsByTagName("HMPG_ADDR")[0].childNodes[0] ? events[i].getElementsByTagName("HMPG_ADDR")[0].childNodes[0].nodeValue : "";

        // í–‰ì‚¬ ì •ë³´ë¥¼ ëª©ë¡ í˜•íƒœë¡œ í‘œì‹œ
        var eventInfo = document.createElement("div");
        eventInfo.classList.add("event-info");

        var mapLink = document.createElement("a");
        mapLink.textContent = "ì§€ë„ë³´ê¸°";
        mapLink.href = "https://www.google.com/maps/search/?api=1&query=" + lot + ", " + lat;
        mapLink.target = "_blank";

		// ì´ë²¤íŠ¸ ì •ë³´ 
		eventInfo.innerHTML = `

							<img src="${main_img}" alt="Main Image">
							<div class=content style="width:100%">
								
								<h3 style="margin: 20px; font-family: Pretendard-Regular; font-weight:600; font-size:30px">${title}</h3>
								
								<div class="row" >
									<div class="col-sm-3"><strong>ë‚ ì§œ</strong></div>
									<div class="col-sm-9">${date}</div>
								</div>
								<hr style="margin:10px">
								<div class="row">
									<div class="col-sm-3"><strong>ì¥ì†Œ</strong></div>
									<div class="col-sm-9">${place} <a href="${mapLink.href}" target="_blank">ì§€ë„ë³´ê¸°</a></div>
								</div>
								<hr>
								<div class="row">
									<div class="col-sm-3"><strong>ê¸°ê´€ëª…</strong></div>
									<div class="col-sm-9">${org_name}</div>
								</div>
								<hr>
								<div class="row">
									<div class="col-sm-3"><strong>ì—°ë ¹</strong></div>
									<div class="col-sm-9">${use_trgt}</div>
								</div>
								<hr>
								<div class="row">
									<div class="col-sm-3"><strong>ì´ìš© ìš”ê¸ˆ</strong></div>
									<div class="col-sm-9">${use_fee}</div>
								</div>
								<hr>
								<div class="row">
									<div class="col-sm-3"><strong>ì‘í’ˆ ì†Œê°œ</strong></div>
									<div class="col-sm-9"><a href="${org_link}">ë³´ëŸ¬ê°€ê¸°</a></div>
								</div>
								<hr>
								<div class="row">
									<div class="col-sm-3"><strong>ì‹ ì²­ì¼</strong></div>
									<div class="col-sm-9">${rgstdate}</div>
								</div>
								<hr>
								<div class="row">
								<button type="button" class="btn btn-default btn-sm col-sm-5 interest-btn" style="height:50px; font-size: 15px;">â­ ê´€ì‹¬ìƒí’ˆ</button>
								<button type="button" class="btn btn-default btn-sm col-sm-5" data-toggle="modal" data-target="#myModal" style="height:50px; font-size: 15px;">ğŸ« ì˜ˆë§¤í•˜ê¸°</button>
								</div>
							</div>
						</div>`;





        eventsListDiv.appendChild(eventInfo);
      }

      // í˜„ì¬ í˜ì´ì§€ í‘œì‹œ
      document.getElementById("currentPage").innerText = currentPage;

      // í˜ì´ì§€ì˜ ë§¨ ìœ„ë¡œ ìŠ¤í¬ë¡¤
      window.scrollTo(0, 0);
    }
  };

  // ìš”ì²­ ë³´ë‚´ê¸°
  xhttp.send();
}

// ì´ì „ í˜ì´ì§€ë¡œ ì´ë™í•˜ëŠ” í•¨ìˆ˜
function prevPage() {
  if (currentPage > 1) {
    loadPage(currentPage - 1);
  }
}

// ë‹¤ìŒ í˜ì´ì§€ë¡œ ì´ë™í•˜ëŠ” í•¨ìˆ˜
function nextPage() {
  loadPage(currentPage + 1);
}

// ê´€ì‹¬ ìƒí’ˆ ë²„íŠ¼ì˜ ìƒ‰ì„ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜
function toggleInterest(button) {
  $(button).toggleClass('interest-selected');
}

// ì´ˆê¸° í˜ì´ì§€ ë¡œë“œ
loadPage(currentPage);

// jQueryë¥¼ ì‚¬ìš©í•˜ì—¬ ê´€ì‹¬ ìƒí’ˆ ë²„íŠ¼ í´ë¦­ ì‹œ ìƒ‰ ë³€ê²½
$(document).ready(function(){
  $(document).on('click', '.interest-btn', function(){
    toggleInterest(this);
  });
});

</script>

</body>
</html>
